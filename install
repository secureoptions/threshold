#! /bin/sh

# This script will go through and install 'threshold' on the local machine. Please see license agreement before continuing https://raw.githubusercontent.com/secureoptions/threshold/master/LICENSE

if [ $(id -u) -ne 0 ]
then 
	echo ""
	echo "Permission denied (must be superuser)"
	echo ""
    exit
fi
echo "Installing... "

mkdir /etc/threshold/
mkdir /etc/threshold/pids/
mkdir /etc/threshold/triggers/
mkdir /etc/threshold/actions/
mkdir /etc/threshold/curlpids/

# Check if device is a Mac or *nix
sw_vers > /dev/null
result=$?

if [ $result -eq 0 ]
then
   curl -o /usr/local/bin/threshold https://raw.githubusercontent.com/secureoptions/threshold/master/threshold.sh >> /dev/null 
   chmod 755 /usr/local/bin/threshold
else 
   curl -o /usr/bin/threshold https://raw.githubusercontent.com/secureoptions/threshold/master/threshold.sh >> /dev/null 
   chmod 755 /usr/bin/threshold
 fi

curl -o /usr/share/man/man1/threshold.1 https://raw.githubusercontent.com/secureoptions/threshold/master/threshold.1.man >> /dev/null
gzip /usr/share/man/man1/threshold.1 >> /dev/null

echo ""
echo "Done!"
echo "Use \"man threshold\" for usage details"

rm -- $0
