.TH threshold 1 "28 July 2017" "version 1.0"

.SH NAME
threshold \- a simple monitor and trigger tool

.SH SYNOPSIS
.B Example Syntax
   threshold -ciPt -d
.I "target"
-a "
.I action
"

.B Example Usage
   threshold -t 1 -i 3 -c 5 -d 192.168.0.1 -a "tcpdump -i eth0 -W 1 -C 10 -w my.pcap"
  
.SH DESCRIPTION
threshold is a network tool which allows you to set up a simple monitor/trigger job. For example can create a continuous ping or netcat to a target IP or host. If the threshold fails, then the user-defined action will be executed.
  
.SH OPTIONS
.B 
.IP "-a | --action"
The user-defined action to take if the threshold monitor is triggered. This can be just about any command that you can execute from a linux system CLI.

.B 
.IP "-b | --backoff"
Default is 60. Only used when specifying a http:// or https:// as target host (-d). This is the interval in seconds between consecutive download tests. It is sometimes needed if a target webserver throttles consecutive web requests from the same source.

.B
.IP "-c | --count"
Default is 3. The number of *consective* pings that must fail before the threshold monitor is considered to be in a failed state. If used with TCP handshakes (-P), it's the number of consecutive handshakes that must fail before the monitor is considered in a failed state. 

.B
.IP "-d | --destination"
The target host IP or DNS hostname that you want to monitor. If this host becomes unresponsive for the parameters you define, then the action (-a "<ACTION>") is taken. __Important Note:__ if you use a prefix of http:// or https:// in the destination, this will create a download monitor which checks the actual download transfer time against the timeout (-t) that you have defined. If the download transfer time exceeds the timeout, then the monitor is considered in a failed state.

.B
.IP "-i | --interval"
Default is 5. The interval in seconds at which you want to send out individual ping packets. If used with TCP (-P), the interval in seconds that TCP handshakes will be initiated.

.B
.IP "-k | --kill"
Use to kill either a specific threshold monitor job (ie. threshold -k 3509) or kill ALL jobs (ie. threshold -k)

.B
.IP "-l | --list"
List the active threshold monitor jobs

.B
.IP "-P | --port"
The TCP port that will be used to establish TCP handshakes on. Using this flag will also cause threshold to use a TCP-handshake monitor rather than a ping monitor. 

.B
.IP "-L | --latency"
The maximum latency in milliseconds that a ping monitor can *average*. A ping monitor's average is calculated based on the number of pings it uses (-c). Therefore, its average latency reading is more accurate with the higher number of pings it's configured to use.

.B
.IP "-o | --logging"
User-defined log location for threshold. This is logging for threshold monitoring (not to be confused with *action* output). Default location is /var/log/threshold.log

.B
.IP "-t | --timeout"
Default is 1. The time in seconds to wait for a response back to ping or TCP SYN/ACK from target. If used with (-P) then timeout is not only the amount of time to wait for response for TCP SYN/ACK, but also the time to wait before sending FIN on successful TCP connections.

.B
.IP "-v | --version"
see the current version of threshold

.B
.IP "-p | --persist"
When setting this argument, your threshold monitor will remain persistent even if it has failed once. In this scenario, the monitor will execute the action you define, and then start itself again with same job parameters. 

.B
.IP "-6 | --ipv6"
Uses ipv6 rather than ipv4. It is important that you add this option to the end of the entire command

.B
.IP "-u | --uninstall"
Uninstall threshold from your system. This will also stop any current jobs you have running.

.SH BUGS
No known bugs at this time. Please contact benfowler2012@gmail.com if you come across any
 
.SH AUTHOR
Ben Fowler (benfowler2012@gmail.com)
